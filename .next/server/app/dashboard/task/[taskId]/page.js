(()=>{var e={};e.id=530,e.ids=[530],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},14300:e=>{"use strict";e.exports=require("buffer")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},94216:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=r(67096),a=r(16132),n=r(37284),i=r.n(n),o=r(32564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["dashboard",{children:["task",{children:["[taskId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,21662)),"C:\\Users\\STW\\OneDrive\\Dokumenty\\VSC Projects\\Tasker-For-Firebase\\app\\dashboard\\task\\[taskId]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,66660)),"C:\\Users\\STW\\OneDrive\\Dokumenty\\VSC Projects\\Tasker-For-Firebase\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,35345)),"C:\\Users\\STW\\OneDrive\\Dokumenty\\VSC Projects\\Tasker-For-Firebase\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\STW\\OneDrive\\Dokumenty\\VSC Projects\\Tasker-For-Firebase\\app\\dashboard\\task\\[taskId]\\page.tsx"],u="/dashboard/task/[taskId]/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/task/[taskId]/page",pathname:"/dashboard/task/[taskId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},79588:(e,t,r)=>{Promise.resolve().then(r.bind(r,91091))},91091:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>TaskPage});var s=r(30784),a=r(57114),n=r(9885),i=r(66558),o=r(33770),l=r(95555),d=r(83022),c=r(40516),u=r(4292),p=r(32451),m=r(52196),h=r(42050),x=r(20599);function TaskPage(){let{taskId:e}=(0,a.useParams)(),{register:t,handleSubmit:r,reset:f,setValue:g,watch:j}=(0,i.cI)(),y=(0,a.useRouter)(),[k,w]=(0,n.useState)(null),[b,_]=(0,n.useState)({}),[S,v]=(0,n.useState)({}),[C,D]=(0,n.useState)(!0),[N,P]=(0,n.useState)([]),[T,I]=(0,n.useState)(!1),[F,q]=(0,n.useState)(null),[O,E]=(0,n.useState)("");if((0,n.useEffect)(()=>{let fetchTask=async()=>{try{let t=await fetch("/api/postgres/get-task",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:e})});if(t.ok){let e=await t.json();w(e.task)}else console.error("Failed to fetch task")}catch(e){console.error("Error fetching task:",e)}finally{D(!1)}};if(!e||isNaN(Number(e))){console.error("Brak taskId"),D(!1),setTimeout(()=>y.push("/"),5e3);return}let fetchReminders=async()=>{try{let t=await fetch("/api/postgres/get-reminders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({task_id:e})});if(t.ok){let e=await t.json();P(e.reminders)}else console.error("Failed to fetch reminders")}catch(e){console.error("Error fetching reminders:",e)}};fetchTask(),fetchReminders()},[e]),(0,n.useEffect)(()=>{if(F){let e=F.getFullYear()+"-"+String(F.getMonth()+1).padStart(2,"0")+"-"+String(F.getDate()).padStart(2,"0");g("reminder_date",e)}},[F]),C)return s.jsx(d.$j,{});if(!k)return s.jsx("div",{children:"Task not found"});let addReminder=async()=>{let t=j("reminder_date"),r=j("reminder_time"),s=new Date(`${t} ${r}:00`);try{let t=await fetch("/api/postgres/reminders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({task_id:e,reminder_time:s})});if(t.ok){let e=await t.json();P([...N,e])}else console.error("Failed to add reminder")}catch(e){console.error("Error adding reminder:",e)}},updateReminder=async(e,t)=>{try{let r=await fetch("/api/postgres/reminders",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,reminder_time:t})});if(r.ok){let t=await r.json();P(N.map(r=>r.id===e?t:r))}else console.error("Failed to update reminder")}catch(e){console.error("Error updating reminder:",e)}},deleteReminder=async e=>{try{let t=await fetch("/api/postgres/reminders",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});t.ok?P(N.filter(t=>t.id!==e)):console.error("Failed to delete reminder")}catch(e){console.error("Error deleting reminder:",e)}},handleDoubleClick=(e,t)=>{_({...b,[e]:!0}),v({...S,[e]:t})},handleInputChange=(e,t)=>{v({...S,[e]:t})},handleKeyDown=async(t,r)=>{if("Enter"===t.key){try{let t=await fetch("/api/postgres/update-task",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:e,[r]:S[r]})});if(t.ok){let e=await t.json();w(e)}else console.error("Failed to update task")}catch(e){console.error("Error updating task:",e)}_({...b,[r]:!1})}else"Escape"===t.key&&_({...b,[r]:!1})};return(0,s.jsxs)("div",{className:"p-5 w-full d-flex flex-row justify-stretch gap-5",children:[(0,s.jsxs)(x.Zb,{className:"w-full h-full",children:[(0,s.jsxs)(x.Ol,{className:"w-full d-flex flex-row gap-3 items-center",children:[s.jsx(l.z,{className:"w-min",onClick:()=>y.back(),variant:"outline",children:s.jsx(m.FontAwesomeIcon,{icon:h.acZ})}),s.jsx("h1",{className:"text-2xl font-bold m-0",onDoubleClick:()=>handleDoubleClick("title",k.title),children:b.title?s.jsx(o.I,{value:S.title,onChange:e=>handleInputChange("title",e.target.value),onKeyDown:e=>handleKeyDown(e,"title")}):k.title})]}),(0,s.jsxs)(x.aY,{className:"flex-row flex-wrap justify-between gap-5 p-4 w-auto",children:[(0,s.jsxs)("p",{className:"d-flex flex-column gap-2",children:[s.jsx("strong",{children:"Opis:"}),s.jsx("span",{onDoubleClick:()=>handleDoubleClick("description",k.description||""),children:b.description?s.jsx(o.I,{value:S.description,onChange:e=>handleInputChange("description",e.target.value),onKeyDown:e=>handleKeyDown(e,"description")}):k.description||"Brak opisu"})]}),(0,s.jsxs)("p",{className:"d-flex flex-column gap-2",children:[s.jsx("strong",{children:"Termin:"}),s.jsx("span",{onDoubleClick:()=>handleDoubleClick("due_date",k.due_date.toISOString()||""),children:b.due_date?s.jsx(o.I,{type:"date",value:S.due_date,onChange:e=>handleInputChange("due_date",e.target.value),onKeyDown:e=>handleKeyDown(e,"due_date")}):k.due_date?new Date(k.due_date).toLocaleDateString():"Brak terminu"})]}),(0,s.jsxs)("p",{className:"d-flex flex-column gap-2",children:[s.jsx("strong",{children:"Status:"}),k.is_completed?s.jsx(m.FontAwesomeIcon,{icon:h.LEp,className:"text-green-500 ml-0 mr-auto"}):s.jsx(m.FontAwesomeIcon,{icon:h.YIN,className:"text-red-500 ml-0 mr-auto"})]})]}),s.jsx(x.eW,{children:(0,s.jsxs)(c.Vq,{open:T,onOpenChange:I,children:[s.jsx(c.hg,{asChild:!0,children:(0,s.jsxs)(l.z,{onClick:()=>I(!0),variant:"outline",title:"Dodaj przypomnienie",children:[s.jsx(m.FontAwesomeIcon,{icon:h.qmU}),"Dodaj"]})}),(0,s.jsxs)(c.cZ,{className:"w-[100vw] h-[100vh] d-flex flex-column justify-start md:w-auto md:h-auto md:min-w-[30%]",children:[s.jsx(c.fK,{className:"d-flex flex-row items-center",children:s.jsx(c.$N,{className:"m-0",children:"Dodaj nowe przypomnienie"})}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),addReminder()},className:"space-y-4",children:[(0,s.jsxs)("div",{className:"d-flex flex-column justify-center items-center",children:[s.jsx(p._,{className:"mr-auto ml-0",htmlFor:"date",children:"Data przypomnienia:"}),s.jsx(u.f,{mode:"single",selected:F,onSelect:e=>q(e)}),s.jsx(o.I,{className:"w-min",id:"reminder_time",type:"time",...t("reminder_time",{required:!0})})]}),s.jsx(l.z,{variant:"outline",type:"submit",className:"w-full",children:"Zapisz"})]})]})]})})]}),N&&N.length>0&&(0,s.jsxs)(x.Zb,{className:"w-full h-full",children:[s.jsx(x.Ol,{children:s.jsx("h2",{className:"text-xl font-bold mb-2",children:"Przypomnienia"})}),s.jsx(x.aY,{children:s.jsx("ul",{className:"d-flex flex-column",children:N&&N.map(e=>(0,s.jsxs)("li",{className:"d-flex flex-row justify-between p-3 items-center hover:rounded hover:bg-gray-100",children:[s.jsx("span",{className:"text-lg",children:new Date(e.reminder_time).toLocaleString()}),(0,s.jsxs)("div",{children:[s.jsx(l.z,{variant:"outline",onClick:()=>updateReminder(e.id,new Date),children:s.jsx(m.FontAwesomeIcon,{icon:h.IwR})}),s.jsx(l.z,{variant:"outline",onClick:()=>deleteReminder(e.id),children:s.jsx(m.FontAwesomeIcon,{icon:h.$aW})})]})]},e.id))})})]})]})}},21662:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var s=r(95153);let a=(0,s.createProxy)(String.raw`C:\Users\STW\OneDrive\Dokumenty\VSC Projects\Tasker-For-Firebase\app\dashboard\task\[taskId]\page.tsx`),{__esModule:n,$$typeof:i}=a,o=a.default,l=o}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[440,397,774,570,488,157,83],()=>__webpack_exec__(94216));module.exports=r})();